# ========================================
# WORKFLOW TEMPLATE - File Sync to Platform
# ========================================
# 
# Location: your-org/m-nikolovska-mak-system/.github/workflow-templates/sync-to-platform.yml
# 
# This is a GitHub workflow template that appears in the
# "Actions" â†’ "New workflow" menu for all organization members.
# 
# Users can click "Set up this workflow" and it will be
# pre-populated with this content.
# ========================================

name: Sync to Platform Repo

on:
  release:
    types: [published]

jobs:
  sync-to-platform:
    name: Sync Files to Platform
    uses: m-nikolovska-mak-system/reusable-actions-library/.github/workflows/sync-to-platform-reusable.yml@main
    
name: Sync to Platform Repo

on:
  release:
    types: [published]

jobs:
  sync-to-platform:
    name: Sync Files to Platform
    uses: m-nikolovska-mak-system/reusable-actions-library/.github/workflows/sync-to-platform-reusable.yml@main
    
    with:
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # ğŸ“ WHAT FILES TO SYNC
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # List the files and folders you want to sync to the platform repo.
      # You can use patterns (wildcards) to match multiple files.
      #
      # Pattern Examples:
      #   config/**           - All files in config/ folder and subfolders
      #   src/main/**/*.java  - All Java files in src/main/ tree
      #   *.md                - All Markdown files in root directory
      #   docs/**/*.pdf       - All PDF files anywhere in docs/
      #   README.md           - Specific file
      #   lib/*.jar           - All JAR files in lib/ folder (not subfolders)
      #
      # Common Use Cases:
      #   ğŸ“„ Config files only:     config/**, *.yml, *.yaml
      #   ğŸ“š Documentation only:    docs/**, README.md, *.md
      #   ğŸ”§ Build artifacts:       build/libs/**, dist/**
      #   ğŸ“¦ Everything:            **  (all files - use with caution!)
      #   ğŸ¯ Specific folders:      src/main/**, tests/**
      #
      # ğŸ’¡ Tips:
      #   - List one pattern per line
      #   - Start specific, expand later if needed
      #   - Test patterns locally: git ls-files 'your-pattern'
      #   - Remove the "# TODO" line below when ready
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      source_files: |
        # TODO: Replace these with your actual files/patterns
        config/**
        README.md
        # Add more patterns below (one per line):
        # docs/**
        # src/main/**
        # build.gradle
      
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # ğŸ”„ SYNC MODE
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # Controls which files are synced on each release.
      #
      # Options:
      #   'changed' (Recommended) - Only sync files that changed since the 
      #                            last release. Efficient and fast.
      #                            Use when: Most releases only modify a few files
      #
      #   'all'                  - Always sync all files matching the patterns
      #                            above, even if they haven't changed.
      #                            Use when: You want to ensure files are always 
      #                            up-to-date, or for critical config files
      #
      # ğŸ’¡ Tips:
      #   - Start with 'changed' - it's faster and more efficient
      #   - Use 'all' for important files that must always be in sync
      #   - First release always syncs all files (no previous release to compare)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      sync_mode: 'changed'
      
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # ğŸ¯ DESTINATION REPOSITORY
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # Where should files be copied to?
      #
      # Format: 'organization-name/repository-name'
      #
      # Examples:
      #   'm-nikolovska-mak-system/platform-repo'  (default platform repo)
      #   'my-company/shared-configs'              (alternative repo)
      #   'my-org/central-library'                 (another option)
      #
      # âš ï¸ IMPORTANT:
      #   - You must have write access to this repository
      #   - The PLATFORM_PAT secret must have permissions for this repo
      #   - Ask your platform team if unsure which repo to use
      #
      # ğŸ’¡ Most teams should keep the default below unless specifically told otherwise
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      destination_repo: 'm-nikolovska-mak-system/platform-repo'
      
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # ğŸ“‚ DESTINATION PATH
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # Where in the destination repo should your files be copied?
      # This creates a folder structure to organize multiple products.
      #
      # Examples:
      #   'products/my-project'        - Good for product repos
      #   'shared/my-library'          - Good for shared libraries
      #   'configs/my-service'         - Good for configuration repos
      #   'teams/frontend/my-app'      - Good for team-organized repos
      #   ''                           - Root directory (not recommended)
      #
      # Your files will appear at:
      #   platform-repo/[destination_path]/[your-files-with-structure]
      #
      # Example with 'products/my-project':
      #   Source:      config/app.yml
      #   Destination: platform-repo/products/my-project/config/app.yml
      #
      # âš ï¸ TODO: Change 'my-project' to your actual project/repo name
      #
      # ğŸ’¡ Tips:
      #   - Use lowercase and hyphens: 'my-app' not 'MyApp'
      #   - Match your repo name for consistency
      #   - This folder is created automatically if it doesn't exist
      #   - Don't use spaces or special characters
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      destination_path: 'products/my-project'
      
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # ğŸ“ PRESERVE DIRECTORY STRUCTURE
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # Should the original folder structure be kept?
      #
      # Options:
      #   true  (Recommended) - Keeps your folder structure intact
      #                         Example: src/main/App.java â†’ 
      #                                  dest/src/main/App.java
      #                         Use when: You want to maintain organization
      #
      #   false               - Flattens everything into one folder
      #                         Example: src/main/App.java â†’ dest/App.java
      #                         Use when: Syncing build artifacts or libs
      #                                   that don't need folder structure
      #
      # Real Examples:
      #   preserve_structure: true
      #     Source:      config/database.yml
      #     Destination: products/my-project/config/database.yml âœ…
      #
      #   preserve_structure: false
      #     Source:      config/database.yml
      #     Destination: products/my-project/database.yml âœ…
      #
      # ğŸ’¡ Tips:
      #   - Use 'true' for source code and configs (most common)
      #   - Use 'false' for build artifacts (JARs, executables)
      #   - When in doubt, use 'true'
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      preserve_structure: true
      
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # ğŸ·ï¸ CREATE MATCHING TAG
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # Should a release tag be created in the destination repo?
      #
      # Options:
      #   true  (Recommended) - Creates matching tag in destination repo
      #                         Helps track which version was synced
      #                         Example: Your v1.2.3 creates platform tag
      #
      #   false               - No tag created in destination repo
      #                         Use when: You don't want version tracking
      #                                   or sync to multiple destinations
      #
      # What happens with 'true':
      #   - You create release v1.2.3 in your repo
      #   - Tag 'my-project-v1.2.3' is created in platform repo
      #   - Easy to see what version of your project is in platform repo
      #
      # ğŸ’¡ Tips:
      #   - Use 'true' for better version tracking (recommended)
      #   - Set to 'false' if you sync to multiple repos (avoids conflicts)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      create_tag: true
      
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # ğŸ”– TAG PREFIX
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # Prefix added to tags in the destination repo to distinguish products.
      #
      # Examples:
      #   'my-project-'    â†’ v1.2.3 becomes my-project-v1.2.3
      #   'frontend-app-'  â†’ v1.0.0 becomes frontend-app-v1.0.0
      #   'lib-auth-'      â†’ v2.5.1 becomes lib-auth-v2.5.1
      #   ''               â†’ v1.2.3 stays as v1.2.3 (not recommended)
      #
      # Why use a prefix?
      #   - Platform repo contains files from many products
      #   - Prefixes prevent tag conflicts between products
      #   - Makes it clear which product a tag belongs to
      #
      # âš ï¸ TODO: Change 'my-project' to match your project name
      #
      # ğŸ’¡ Tips:
      #   - Match your repo name: repo 'auth-service' â†’ prefix 'auth-service-'
      #   - Use lowercase and hyphens
      #   - Always include the trailing dash (-)
      #   - Be consistent across your team
      #
      # Example Timeline:
      #   You release:  v1.0.0, v1.1.0, v2.0.0
      #   Platform gets: my-project-v1.0.0, my-project-v1.1.0, my-project-v2.0.0
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      tag_prefix: 'my-project-'
      
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # ğŸ’¬ COMMIT MESSAGE TEMPLATE
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # Message used when committing files to the destination repo.
      #
      # Available Variables:
      #   {repo}  - Your repository name (e.g., 'my-org/my-project')
      #   {tag}   - Release tag (e.g., 'v1.2.3')
      #   {files} - Number of files synced (e.g., '5')
      #
      # Examples:
      #   'ğŸ”„ Sync from {repo} release {tag} ({files} files)'
      #   â†’ "ğŸ”„ Sync from my-org/my-app release v1.2.3 (5 files)"
      #
      #   'Update from {repo} - version {tag}'
      #   â†’ "Update from my-org/my-app - version v1.2.3"
      #
      #   'Release {tag}: Synced {files} files from {repo}'
      #   â†’ "Release v1.2.3: Synced 5 files from my-org/my-app"
      #
      # ğŸ’¡ Tips:
      #   - Use emojis for better visibility in commit history
      #   - Include {repo} so you know which product updated
      #   - Include {tag} for version tracking
      #   - The default below works great for most cases
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      commit_message_template: 'ğŸ”„ Sync from {repo} release {tag} ({files} files)'
    
    secrets:
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # ğŸ” AUTHENTICATION SECRET
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # Personal Access Token (PAT) that allows writing to the platform repo.
      #
      # âš ï¸ CRITICAL: You MUST set this up before the workflow will work!
      #
      # Setup Steps:
      #   1. Create PAT (if you don't have one):
      #      - Go to: GitHub â†’ Your Profile (top right) â†’ Settings
      #      - Scroll down: Developer settings â†’ Personal access tokens
      #      - Click: "Generate new token" â†’ "Generate new token (classic)"
      #      - Note: "Platform Repo Sync"
      #      - Expiration: 90 days (or longer if allowed)
      #      - Scopes: Check âœ… "repo" (full control of private repositories)
      #      - Click: "Generate token"
      #      - âš ï¸ COPY THE TOKEN NOW - you won't see it again!
      #
      #   2. Add PAT as repository secret:
      #      - Go to: This repository â†’ Settings tab
      #      - Click: Secrets and variables â†’ Actions
      #      - Click: "New repository secret"
      #      - Name: PLATFORM_PAT  (must match exactly)
      #      - Secret: Paste your token (starts with ghp_...)
      #      - Click: "Add secret"
      #
      #   3. Verify it worked:
      #      - Secrets â†’ Actions â†’ Look for "PLATFORM_PAT" âœ…
      #
      # Troubleshooting:
      #   âŒ "Secret not found"           â†’ Secret name must be exactly "PLATFORM_PAT"
      #   âŒ "Permission denied"          â†’ PAT needs 'repo' scope
      #   âŒ "Resource not accessible"    â†’ PAT might be expired, create new one
      #
      # Security Notes:
      #   âœ… DO: Store PAT as a secret (never in code)
      #   âœ… DO: Set expiration date (90 days recommended)
      #   âœ… DO: Use minimal permissions needed ('repo' scope only)
      #   âŒ DON'T: Share PAT with anyone
      #   âŒ DON'T: Commit PAT to git
      #   âŒ DON'T: Use PAT with admin permissions
      #
      # ğŸ’¡ Pro Tips:
      #   - PAT expires after 90 days by default - mark your calendar!
      #   - Use organization secrets if syncing from multiple repos
      #   - Test with a dummy release first to verify PAT works
      #   - If PAT expires, generate new one and update the secret
      #
      # âš ï¸ This line should stay exactly as-is (don't change "PLATFORM_PAT")
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      destination_token: ${{ secrets.PLATFORM_PAT }}
